@model ComparisonViewModel
@{
    ViewData["Title"] = "Comparison";
}


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link href="~/css/ratingtable.css" rel="stylesheet" type="text/css" />
<link href="~/css/images.css" rel="stylesheet" type="text/css" />


<script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
@*<link href="~/js/ratingtable.js" type="text/javascript" />*@
<script>
    //$(document).ready(function () {
    //    alert("HELLO");
    //});
    $(document).ready(function() {
        //if ($("lproductName").val().length == 0 || $("rproductName").val().length == 0) return;
        //alert("Doc is ready!");
        $($(".lbar").get().reverse()).each(function (index, element) {
            $(element).width(getLeftFinalWidth(index+1)*100 + '%');
        });
        $($(".rbar").get().reverse()).each(function (index, element) {
            $(element).width(getRightFinalWidth(index+1)*100 + '%');
        });
    });

    //function onHoveredRightImg(index) {
    //    $("img-right-" + index).
    //}
    //function onHoveredRightImgOut(index) {
    //    $("img-rigth-" + index).addClass(".")
    //}
    
    function getLeftFinalWidth(index) {
        switch (index) {
            case 1: return @ComparisonViewModel.LeftProduct?.GetStarsPercent(1);
            case 2: return @ComparisonViewModel.LeftProduct?.GetStarsPercent(2);
            case 3: return @ComparisonViewModel.LeftProduct?.GetStarsPercent(3);
            case 4: return @ComparisonViewModel.LeftProduct?.GetStarsPercent(4);
            case 5: return @ComparisonViewModel.LeftProduct?.GetStarsPercent(5);
        }
    };
    function getRightFinalWidth(index) {
        
        switch (index) {
            case 1: return @ComparisonViewModel.RightProduct?.GetStarsPercent(1);
            case 2: return @ComparisonViewModel.RightProduct?.GetStarsPercent(2);
            case 3: return @ComparisonViewModel.RightProduct?.GetStarsPercent(3);
            case 4: return @ComparisonViewModel.RightProduct?.GetStarsPercent(4);
            case 5: return @ComparisonViewModel.RightProduct?.GetStarsPercent(5);
        }
    };

</script>
<style>
    .checked {
        color: orange;
    }

    .not-checked {
        color: #ddd;
    }
</style>

<form asp-controller="Comparison" asp-area="" asp-action="FindProducts" method="post">
    <div class="form-group">
        <label for="lproductName">Left product name</label>
        <input type="text" class="form-control" name="lproductName" id="lproductName" placeholder="Enter product name" value="" onchange="rfindSimilar()" required />
    </div>
    <div class="form-group">
        <label for="rproductName">Right product name</label>
        <input type="text" class="form-control" name="rproductName" id="rproductName" placeholder="Enter product name" value="" @*onchange="lfindSimilar()"*@ required />
    </div>
    <button class="btn btn-primary" type="submit">Find</button>
</form>
<br>
<div class="container-fluid">
    <div class="row row-cols-1 row-cols-md-3">
        <br>
        @{
            var leftProduct = ComparisonViewModel.LeftProduct;
            var rightProduct = ComparisonViewModel.RightProduct;

            if (leftProduct != null && rightProduct != null)
            {
                <div class="col col-xs-12 col-sm-12 col-md-4 col-lg-4" style="padding-bottom: 2rem;">
                    <div class="card h-100 hoverable-card" id="card_on_transaction">
                        <div class="card-header @leftProduct.GetTableHeaderClassString()" id="card_on_transaction_header">
                            <h5 style="font-weight:300">@leftProduct.Type</h5>
                        </div>
                        <div style="transform:rotate(0);">
                            @*<a href="@product.Link" class="stretched-link">
                                    <img src="@product.GetCardImageSrc()" alt="Cat Lawyer Is Real And He Is Everything Right Now | Above the Law" class="card-img-top">
                                </a>*@
                            <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                                <ol class="carousel-indicators">
                                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                                    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                                    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                                </ol>
                                <div class="carousel-inner">
                                    <div class="carousel-item active">
                                        <img class="d-block w-100 img-fluid catalog-img catalog-comp"  id="img-left-0" onmouseover="onHoveredLeftImg(0)" onmouseout="onHoveredLeftImgOut(0)" src="@leftProduct.GetFirstImageSrc()" alt="First slide">
                                    </div>
                                    <div class="carousel-item">
                                        <img class="d-block w-100 img-fluid catalog-img catalog-comp"  id="img-left-0" onmouseover="onHoveredLeftImg(1)" onmouseout="onHoveredLeftImgOut(1)" src="@leftProduct.GetSecondImageSrc()" alt="Second slide">
                                    </div>
                                    <div class="carousel-item">
                                        <img class="d-block w-100 img-fluid catalog-img catalog-comp"  id="img-left-0" onmouseover="onHoveredLeftImg(2)" onmouseout="onHoveredLeftImgOut(2)" src="@leftProduct.GetThirdImageSrc()" alt="Third slide">
                                    </div>
                                </div>
                                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>
                        <div class="card-body" style="transform:rotate(0);">
                            <h4 class="card-title">
                                @leftProduct.Name
                            </h4>
                            <div class="overflower" aria-hidden="true">
                                <p class="card-text card-description">@leftProduct.Description</p>
                            </div>

                            @*<a href="@product.Link" class="stretched-link"></a>*@
                        </div>

                        <div class="card-footer @leftProduct.GetTableHeaderClassString()" id="card_on_transaction_footer">

                            @*<div class="float-right">*@
                            <h3>
                                @leftProduct.FinalPriceString
                                <sup>
                                    @if (leftProduct.Price != leftProduct.FinalPrice)
                                    {
                                        <font color="red" style="font-weight:400"><del>@leftProduct.PriceString</del></font><sup> -@leftProduct.DiscountSupString</sup>
                                    }
                                </sup>
                            </h3>
                            <br>
                            <small class="text-warning @leftProduct.GetProductTableLinkClassString()">
                                Added @leftProduct.AddedDate.ToShortDateString()
                            </small>

                        </div>
                    </div>
                </div>
                <div class="col col-xs-12 col-sm-12 col-md-4 col-lg-4" style="text-align:center">
                    <div class="card text-white bg-dark h-100">
                        <div class="card-header">Comparison</div>
                        <div class="card-body">
                            <h5 class="card-title">Briefly</h5>
                            <p class="card-text">@ComparisonViewModel.PriceComparisonText()</p>
                            <p class="card-text">@ComparisonViewModel.DiscountComparisonText()</p>
                            <p class="card-text">@ComparisonViewModel.AddedDateComparisonText()</p>
                            <h5 class="card-title">Comments</h5>
                            <p class="card-text">Some comments</p>
                            <h5 class="card-title">Conclusion</h5>
                            <p class="card-text">
                                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="col col-xs-12 col-sm-12 col-md-4 col-lg-4" style="padding-bottom: 2rem;">
                    <div class="card h-100 hoverable-card" id="card_on_transaction">
                        <div class="card-header @rightProduct.GetTableHeaderClassString()" id="card_on_transaction_header">
                            <h5 style="font-weight:300">@rightProduct.Type</h5>
                        </div>
                        <div style="transform:rotate(0);">
                            @*<a href="@rightProduct.Link" class="stretched-link">
                                    <img src="@rightProduct.GetCardImageSrc()" alt="Cat Lawyer Is Real And He Is Everything Right Now | Above the Law" class="card-img-top">
                                </a>*@
                            <div id="carouselExampleIndicators2" class="carousel slide" data-ride="carousel">
                                <ol class="carousel-indicators">
                                    <li data-target="#carouselExampleIndicators2" data-slide-to="0" class="active"></li>
                                    <li data-target="#carouselExampleIndicators2" data-slide-to="1"></li>
                                    <li data-target="#carouselExampleIndicators2" data-slide-to="2"></li>
                                </ol>
                                <div class="carousel-inner">
                                    <div class="carousel-item active">
                                        <img class="d-block w-100 img-fluid catalog-img catalog-comp" id="img-right-0" onmouseover="onHoveredRightImg(0)" onmouseout="onHoveredRightImgOut(0)" src="@rightProduct.GetFirstImageSrc()" alt="First slide">
                                    </div>
                                    <div class="carousel-item">
                                        <img class="d-block w-100 img-fluid catalog-img catalog-comp" id="img-right-1" onmouseover="onHoveredRightImg(1)" onmouseout="onHoveredRightImgOut(1)" src="@rightProduct.GetSecondImageSrc()" alt="Second slide">
                                    </div>
                                    <div class="carousel-item">
                                        <img class="d-block w-100 img-fluid catalog-img catalog-comp" id="img-right-2" onmouseover="onHoveredRightImg(2)" onmouseout="onHoveredRightImgOut(2)" src="@rightProduct.GetThirdImageSrc()" alt="Third slide">
                                    </div>
                                </div>
                                <a class="carousel-control-prev" href="#carouselExampleIndicators2" role="button" data-slide="prev">
                                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Previous</span>
                                </a>
                                <a class="carousel-control-next" href="#carouselExampleIndicators2" role="button" data-slide="next">
                                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                    <span class="sr-only">Next</span>
                                </a>
                            </div>
                        </div>
                        <div class="card-body" style="transform:rotate(0);">
                            <h4 class="card-title">
                                @rightProduct.Name
                            </h4>
                            <div class="overflower" aria-hidden="true">
                                <p class="card-text card-description">@rightProduct.Description</p>
                            </div>

                            @*<a href="@rightProduct.Link" class="stretched-link"></a>*@
                        </div>

                        <div class="card-footer @rightProduct.GetTableHeaderClassString()" id="card_on_transaction_footer">

                            @*<div class="float-right">*@
                            <h3>
                                @rightProduct.FinalPriceString
                                <sup>
                                    @if (rightProduct.Price != rightProduct.FinalPrice)
                                    {
                                        <font color="red" style="font-weight:400"><del>@rightProduct.PriceString</del></font><sup> -@rightProduct.DiscountSupString</sup>
                                    }
                                </sup>
                            </h3>
                            <br>
                            <small class="text-warning @rightProduct.GetProductTableLinkClassString()">
                                Added @rightProduct.AddedDate.ToShortDateString()
                            </small>

                        </div>
                    </div>
                </div>
                <hr>
                <div class="col col-sm-12 col-md-12 col-lg-6" style="padding-top: 2rem;">
                    <div class="card h-100 hoverable-card" id="card_on_transaction">
                        <div class="card-header @leftProduct.GetTableHeaderClassString()" id="card_on_transaction_header">
                            <h5 style="font-weight:300">What people think about <strong>@leftProduct.Name</strong></h5>
                            <p>RATE: @leftProduct.GetRate()</p>
                            @for (int i = 0; i < 5; i++)
                            {
                                if (ComparisonViewModel.GetStarsValue(leftProduct) >= i + 1)
                                {
                                    <i class="fa fa-star checked"></i>
                                }
                                else
                                {
                                    <i class="fa fa-star not-checked"></i>
                                }
                            }
                            <div id="left-rating-table">
                                <div class="row">
                                    <div class="side left">
                                        <div>5 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-5 lbar" id="lbar-5"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@leftProduct.GetStarsCount(5)</div>
                                    </div>
                                    <div class="side left">
                                        <div>4 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-4 lbar" id="lbar-4"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@leftProduct.GetStarsCount(4)</div>
                                    </div>
                                    <div class="side left">
                                        <div>3 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-3 lbar" id="lbar-3"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@leftProduct.GetStarsCount(3)</div>
                                    </div>
                                    <div class="side left">
                                        <div>2 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-2 lbar" id="lbar-2"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@leftProduct.GetStarsCount(2)</div>
                                    </div>
                                    <div class="side left">
                                        <div>1 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-1 lbar" id="lbar-1"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@leftProduct.GetStarsCount(1)</div>
                                    </div>
                                </div>
                            </div>
                            <p class="text-center text-muted"><small><i>from total amount of <b>@leftProduct.GetTotalCountOfNotNulledComments()</b> rated comments</i></small></p>
                        </div>
                        <div class="card-body" style="transform:rotate(0);">
                            @{
                                if (leftProduct.Comments != null)
                                {
                                    foreach (var comment in leftProduct.Comments)
                                    {
                                        <p><strong>@WebMarket.Data.Userbase.GetUsername(comment.UserID)</strong></p>
                                        <p>@comment.Text</p>
                                        if (comment.Rate > 0f)
                                        {
                                            for (int i = 0; i < 5; i++)
                                            {
                                                if (comment.Rate > i)
                                                {
                                                    <i class="fa fa-star checked"></i>
                                                }
                                                else
                                                {
                                                    <i class="fa fa-star not-checked"></i>
                                                }
                                            }
                                        }
                                        <hr />
                                    }
                                }
                                else
                                {
                                    <p><strong>We can't render comments as this product don't have any...</strong></p>
                                }
                            }
                        </div>

                    </div>
                </div>
                <div class="col col-sm-12 col-md-12 col-lg-6" style="padding-top: 2rem;">
                    <div class="card h-100 hoverable-card" id="card_on_transaction">
                        <div class="card-header @rightProduct.GetTableHeaderClassString()" id="card_on_transaction_header">
                            <h5 style="font-weight:300">What people think about <strong>@rightProduct.Name</strong></h5>
                            <p>RATE: @rightProduct.GetRate()</p>
                            @for (int i = 0; i < 5; i++)
                            {
                                if (ComparisonViewModel.GetStarsValue(rightProduct) >= i + 1)
                                {
                                    <i class="fa fa-star checked"></i>
                                }
                                else
                                {
                                    <i class="fa fa-star not-checked"></i>
                                }
                            }
                            <div id="right-rating-table">
                                <div class="row">
                                    <div class="side left">
                                        <div>5 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-5 rbar" id="rbar-5"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@rightProduct.GetStarsCount(5)</div>
                                    </div>
                                    <div class="side left">
                                        <div>4 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-4 rbar" id="rbar-4"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@rightProduct.GetStarsCount(4)</div>
                                    </div>
                                    <div class="side left">
                                        <div>3 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-3 rbar" id="rbar-3"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@rightProduct.GetStarsCount(3)</div>
                                    </div>
                                    <div class="side left">
                                        <div>2 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-2 rbar" id="rbar-2"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@rightProduct.GetStarsCount(2)</div>
                                    </div>
                                    <div class="side left">
                                        <div>1 star</div>
                                    </div>
                                    <div class="middle">
                                        <div class="bar-container">
                                            <div class="bar-1 rbar" id="rbar-1"></div>
                                        </div>
                                    </div>
                                    <div class="side right">
                                        <div>@rightProduct.GetStarsCount(1)</div>
                                    </div>
                                </div>
                            </div>
                            <p class="text-center text-muted"><small><i>from total amount of <b>@rightProduct.GetTotalCountOfNotNulledComments()</b> rated comments</i></small></p>
                        </div>
                        <div class="card-body" style="transform:rotate(0);">
                            @{
                                if (rightProduct.Comments != null)
                                {
                                    foreach (var comment in rightProduct.Comments)
                                    {
                                        <p><strong>@WebMarket.Data.Userbase.GetUsername(comment.UserID)</strong></p>
                                        <p>@comment.Text</p>
                                        if (comment.Rate > 0f)
                                        {
                                            for (int i = 0; i < 5; i++)
                                            {
                                                if (comment.Rate >= i + 1)
                                                {
                                                <i class="fa fa-star checked"></i>
                                                }
                                                else
                                                {
                                                <i class="fa fa-star not-checked"></i>
                                                }

                                            }
                                        }
                                        <hr />
                                    }
                                }
                                else
                                {
                                    <p><strong>We can't render comments as this product don't have any...</strong></p>
                                }
                            }
                        </div>

                    </div>
                </div>
            }
        }
    </div>
</div>


